# Discovering hosts
Existen varias herramientas para descubrimiento de equipos en la red.

Destacar que la mayoría de ellas obvian nuestra IP lo cual facilita la identificación de objetivos. 

Cuando trabajamos en redes NAT, y en redes normales también hay que tener en cuenta estos conceptos, siempre se van a devolver una serie de IPs que en principio obviaremos. Si escaneamos el rango 192.168.11.0/24 siempre aparecerán:

* 192.168.11.1: Es la puerta de enlace.
* 192.168.11.2: Es la IP del host, nuestro windows.
* 192.168.11.254: Simula un DNS.

Por tanto cualquier IP que no sea la nuestra y que no sea ninguna de las anteriores será la IP objetivo. Comenzamos con las herramientas.


## netdiscover

**netdiscover** es una herramienta para descubrir hosts que ya viene preinstalada. Tiene opciones de búsqueda por interface de red, por rango, etc. Podemos buscar por rango con el comando:

```bash
sudo netdiscover -r 192.168.11.0/24

# Tambien

sudo netdiscover -i eth0 -r 172.17.0.0/24 -p -N

```
El resultado seria el siguiente:

![](/.gitbook/assets/host01.png)

Vemos que la IP objetivo sería la 192.168.11.161.

## arp-scan

**arp-scan** trabaja de manera similar a la herramienta anterior. Podemos escanear la red local indicando la interface y el parámetro **--localnet** para que se centre em el rango 0/24.

```bash
sudo arp-scan -I eth0 --localnet
```
El resultado es el mismo..

![](/.gitbook/assets/host02.png)

## nmap
Escanear IPs de un rango
```bash
sudo nmap sn 10.0.2.0/24
```

# Escanear un equipo

## nmap 

Escaneo rápido de puertos abiertos
```bash
sudo nmap -sS -p- --open --min-rate 5000 -vvv -n -Pn 10.0.2.2 -oG allPorts
```

Escaneo de servicios y versiones.
```bash
sudo nmap -sCV -p22,80 10.0.2.2 -oN targeted
```

Escaneo completo.
```bash
sudo nmap -sS -sCV -p- --open --min-rate 5000 -vvv -n -Pn 10.0.2.2 -oN Escaneo.txt
```

## rustscan

Escaneo completo. Instalar release de [RustScan/RustScan](https://github.com/RustScan/RustScan).

```bash
rustscan -a 172.17.0.2 -- -sCV -oN escan
```


## Script manual

En ocasiones tendremos que buscar hosts sin herramientas. Por ejemplo si se hace pivoting a una red desde una máquina que no tiene herramientas.

Podemos crear un script, que llamaremos **hostDiscovering.sh** de la siguiente forma:

```bash
#!/bin/bash

function control_c(){
	echo -e "\n\n[!] Saliendo...\n"
	tput cnorm
	exit 0
}

# Ctlr+C
trap ctlr_c INT

tput .civis

for i in $(seq 1 254); do
	timeout 1 bash -c "ping -c 1 192.168.11.$i" &>/dev/null && echo "[+] El host 192.168.11.$i - ACTIVE" &
done

wait
tput cnorm
```

Le damos permisos de ejecución y lo ejecutamos.

![](/.gitbook/assets/host03.png)

Si quisiéramos que nos mostrara el 254 habría que aumentar la secuencia a 255.

Para saber mas en detalle como y por qué de este script, (que hace tput, ctlr_c, ...), visionar este video a partir del minuto 57:40, <https://www.youtube.com/watch?v=L1jSoCcvRY4>

