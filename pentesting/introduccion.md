# Introducción

Aquí se documentan todos los conocimientos adquiridos en técnicas de **pentesting**.

Una prueba de pentesting consta de las siguientes fases:

## OSINT

Esta fase del pentesting no se utiliza en el estudio con máquinas preparadas ya que siempre se parte de una IP y de una máquina que vemos en la red, normalmente de tipo CTF.

En las auditorias reales, tanto si es una aplicación web pública como dentro de una empresa, hay que realizar esta fase lo primero.

Esta fase consiste en la búsqueda de información en fuentes publicas.

Como no la vamos a usar habitualmente al principio, la describimos un poco mas en detalle.

Si partimos de una aplicación Web, **https://www.maripili.com**, o de una empresa de la que solo sabemos el nombre antes de la auditoria, **Maripili S.A.**, hay que realizar una labor de búsqueda de información averiguando:

* DNSs, direcciones IP. Investigando las IPs, si están en listas negras, país de origen, proveedor de servicios, etc.
* Información de la empresa. Quien es el CEO, que organigrama. 
* Posibles usuarios de la empresa que podamos usar después.
* Correos electrónicos, que asu vez nos proporcionan usuarios.
* Posibles publicaciones o documentos.

Para ello se utilizarán usa serie de herramientas:

* Uso de herramientas de red (Whois, Traceroute, ping…)
* Uso de Owasp-Mantra (http-headers, Passive-recon…)
* Extracción de metadatos en documentos encontrados (FOCA)
* Plugins de Firefox útiles
* Herramientas OSINT:
    * **TheHarvester**: Su objetivo es recopilar correos electrónicos, subdominios, hosts, nombres de empleados, puertos abiertos, etc. de varias fuentes públicas, como motores de búsqueda, servidores de claves PGP y la base de datos de computadoras Shodan.
    * **Shodan**: Es un motor de búsqueda muy potente que permite encontrar diferentes equipos conectados a internet a través de filtros. Se le conoce como el ‘Google de los hackers’ y sirve para encontrar * **servidores, routers, webcams, dispositivos IOT, etc.
    * **Google Dorks**: Esta herramienta utiliza los operadores de Google para realizar búsquedas avanzadas. Ofrece información de todo tipo y muy valiosa.
    * **Bing Dorks**: Es parecida a la herramienta anterior pero cuenta con distintas opciones y posibilidades que pueden ofrecer resultados de búsqueda diferentes.
    * **Maltego.**: Esta potente herramienta recopila información sobre un objetivo y nos la proporciona en forma de gráfico, para facilitarnos el análisis de los datos.
    * **NexVision**: Esta aplicación utiliza la inteligencia artificial para ofrecer información en tiempo real de toda la web, incluidas búsquedas en la web oscura.
    * **Social Links**: Esta herramienta utiliza también la inteligencia artificial para extraer, analizar y visualizar datos de fuentes abiertas, incluyendo redes sociales, mensajes, Dark Web, etc.
* Ingeniería social

## Enumeración

Lo primero es enumerar el sistema. Se estudiarán técnicas de enumeración como:

* Descubrimiento de hosts
* Descubrimiento de puertos
* Descubrimiento de directorios y recursos web.
* Descubrimiento de vulnerabilidades
* Descubrimiento de usuarios, contraseñas, credenciales, hashses, claves id_rsa, .....
* ....

Realizada una buena enumeración es posible conseguir un vector de explotación.

## Explotación

En base aa la enumeración se consiguen uno o varios vectores de ataque. Llega el momento de explotarlos y acceder al sistema.

Veremos varias técnicas de explotación:

* Explotación con herramientas automatizadas.
* Explotación de forma manual.
* Explotación por fuerza bruta
* ...

## Escalada de privilegios

Normalmente en la explotación se accede al sistema con un usuario de bajos privilegios. 

La escalada de privilegios son las técnicas que permiten obtener privilegios de **root** en Linux o de **Administrator** en Windows.

Se estudiarán las diferentes formas de conseguirlo.

## Persistencia

Esta fase no suele hacerse en auditorias. Consiste en crear una persistencia para poder acceder al sistema cuando se desee de forma sigilosa. No es una fase muy ética, pero conviene saber alguna cosa.

## Reporting

Una vez vulnerado un sistema hay que hacer el informe.ç

Normalmente se hacen dos reportes:

* **Informe ejecutivo**: Informe dirigido a la dirección, con un resumen de la auditoria a grandes rasgos.
* **Informe Técnico**: Informe mas detallado dirigido al personal técnico para que solucione los problemas encontrados.

Se intentará dejar plantillas y ejemplos de estos informes.

